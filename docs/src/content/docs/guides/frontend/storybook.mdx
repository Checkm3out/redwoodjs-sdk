---
title: Storybook
description: A step-by-step guide for installing and configuring Storybook in Redwood SDK projects.
---

import { Aside, Steps } from '@astrojs/starlight/components';

<Aside type="note" title="What is Storybook?">
  <p>
    Storybook is a tool for developing UI components in isolation. It allows you to create and test components without needing to run your full application. It can also be a great way to document your components.
  </p>
  <p>
    Developing UI in isolation is especially useful if you have a component that relies on network requests or your database â€” you can mock any dependencies and focus on building the component itself.
  </p>
  <p>
    This guide covers setup and some basics. For full documentation and some demos, see the <a target="_blank" href="https://storybook.js.org">Storybook site</a>.
  </p>
</Aside>

## Installing Storybook

Because the RedwoodSDK is based on React and Vite, we can work through the <a target="_blank" href="https://storybook.js.org/docs/get-started/frameworks/react-vite">"React & Vite" documentation</a>.

<Steps>
1. Install Storybook
    ```bash
    pnpm create storybook@latest
    ```

2. Select what you want to use Storybook for. I selected both Documentation and Testing.
    ![](./images/sb-select-use.png)

3. It'll say it can't detect the framework. Select React. It'll automatically detect Vite.
    ![](./images/sb-select-react.png)

4. Storybook will finish installing, and start your Storybook server.
    ![](./images/sb-started.png)

5. It should automatically open your browser to Storybook, but if it doesn't, you can go to `localhost:6006` to see it.
    ![](./images/sb-served-site.png)

7. You'll also see that it added `storybook` and `storybook-build` scripts to your `package.json` file. You can always run `pnpm storybook` to start the Storybook server, and `pnpm storybook-build` to build your Storybook site for production.
    ```json
    {
      "scripts": {
        "storybook": "storybook dev -p 6006",
        "storybook-build": "storybook build"
      }
    }
    ```

</Steps>

<Aside type="note" title="Wait, Storybook is showing me some random components!">
  <p>
    Storybook comes with some boilerplate components and stories. You can delete the `src/stories` folder to get rid of them.
  </p>
  <p>
    Still, if you're new to Storybook, I recommend keeping them around for a bit and taking a look at the files it added. They show you how to set up a Storybook component and how to use and customize the Storybook UI.
  </p>
</Aside>

## Adding a Component to Storybook

In writing this guide, we've started by following the [quick start instructions](../../getting-started/quick-start) and set up the standard starter.

The standard starter comes with a very basic `Home` component:

```tsx title="src/app/pages/Home.tsx"
import { RequestInfo } from "@redwoodjs/sdk/worker";

export function Home({ ctx }: RequestInfo) {
  return (
    <div>
      <p>
        {ctx.user?.username
          ? `You are logged in as user ${ctx.user.username}`
          : "You are not logged in"}
      </p>
    </div>
  );
}
```

Given that this is very basic, you'd most likely want to build this out a bit more. Storybook is the perfect place to do that! Let's see what that looks like.

<Steps>
1. Create a new file: `src/app/pages/Home.stories.tsx`
    ```tsx title="src/app/pages/Home.stories.tsx"
    import type { Meta, StoryObj } from "@storybook/react";

    import { Home } from "./Home";

    const meta: Meta<typeof Home> = {
      component: Home,
    };

    export default meta;
    type Story = StoryObj<typeof Home>;

    export const NotLoggedIn: Story = {
      args: {
        ctx: {
          user: null,
          session: null,
        },
      },
    };
    ```
2. Save it, and go back to your Storybook site. You should see a new "Home" section in the sidebar:
    ![](./images/sb-home-story-1.png)

3. Great! What if we want to mock the logged in user? We can do that by adding a new story:
    ```tsx title="src/app/pages/Home.stories.tsx" ins={21-32}
    import type { Meta, StoryObj } from "@storybook/react";

    import { Home } from "./Home";

    const meta: Meta<typeof Home> = {
      component: Home,
    };

    export default meta;
    type Story = StoryObj<typeof Home>;

    export const NotLoggedIn: Story = {
      args: {
        ctx: {
          user: null,
          session: null,
        },
      },
    };

    export const LoggedIn: Story = {
      args: {
        ctx: {
          user: {
            id: "1",
            username: "redwood_fan_123",
            createdAt: new Date(),
          },
          session: null,
        },
      },
    };
    ```

4. Save it, and go back to your Storybook site. You should see a new "Logged In" story:
    ![](./images/sb-home-story-2.png)
    <Aside type="note" title="What even is a story?">
      <p>
        Given that the tool we're using is called "Storybook," it makes sense that it's made up of "stories."
      </p>
      <p>
        A story captures a single state of a component. It can be thought of as a "use case" for the component.
      </p>
      <p>
        For example, in our case, we have two stories: "Not Logged In" and "Logged In." Each story shows a different state of the `Home` component.
        You can have as many stories as you want for a component. In fact, it's recommended to have a story for each state of the component.
        As you continue building a component, checking back on its stories is also a great way to make sure that you haven't broken anything.
      </p>
      <p>
        Read more about this in the <a target="_blank" href="https://storybook.js.org/docs/get-started/whats-a-story">official Getting Started documentation</a>.
      </p>
    </Aside>

5. Great! But what if we want to be able to play around with the username that's displayed? Sure, you can always click into the
    generated controls and change the username, but it's a little ugly. What if we want to just have a dropdown with some options?<br /><br />
    Thankfully, Storybook lets us override the generated controls via [argTypes](https://storybook.js.org/docs/api/arg-types)!<br /><br />
    Username is nested in our `ctx` prop, and Storybook controls are meant to correspond with a given prop, so we need to create an array
    of all the `ctx` possibilities we want to test out. We can then give them each a pretty name, and Storybook will generate a dropdown for us â€”
    if you specify a list of options, [Storybook will know to use a dropdown control](https://storybook.js.org/docs/api/arg-types#control).<br /><br />
    Let's do it:

    ```tsx title="src/app/pages/Home.stories.tsx" ins={32-50} collapse={1-20}
    import type { Meta, StoryObj } from "@storybook/react";

    import { Home } from "./Home";

    const meta: Meta<typeof Home> = {
      component: Home,
    };

    export default meta;
    type Story = StoryObj<typeof meta>;

    export const NotLoggedIn: Story = {
      args: {
        ctx: {
          user: null,
          session: null,
        },
      },
    };

    export const LoggedIn: Story = {
      args: {
        ctx: {
          user: {
            id: "1",
            username: "redwood_fan_123",
            createdAt: new Date(),
          },
          session: null,
        },
      },
      argTypes: {
        ctx: {
          options: ["redwood_fan_123", "storybook_user", "example_user"],
          mapping: {
            redwood_fan_123: {
              user: { id: "1", username: "redwood_fan_123", createdAt: new Date() },
              session: null,
            },
            storybook_user: {
              user: { id: "2", username: "storybook_user", createdAt: new Date() },
              session: null,
            },
            example_user: {
              user: { id: "3", username: "example_user", createdAt: new Date() },
              session: null,
            },
          },
        },
      },
    };
    ```

6. Save it, and go back to your Storybook site. You should see a new dropdown for the `ctx` prop â€” give it a try!
    ![](./images/sb-ctx-argtypes.gif)
</Steps>

You did it! ðŸŽ‰ <br />
You now have a fully functional Storybook set up with a component that you can play around with.

## Mocking a dependency that's not a prop

In the previous section, we mocked the `ctx` prop. But what if we want to mock a dependency that isn't a prop? For example, let's say we have a component that makes calls to our
database via Prisma.

ARI YOU ARE UP TO THIS :)
